import{r as s,bo as t}from"./vendor-c7d66446.js";import{R as a,S as W,Q as X,E as Y,A as Z,a as p,b as $,c as ee,d as te}from"./index-0b74e974.js";import{g as se,d as oe,D as ne,T as N,e as ae,C as w,f as ie}from"./fluentui-react-74c93fca.js";import"./fluentui-icons-e75fed20.js";const re="_oneshotContainer_p6613_1",le="_oneshotTopSection_p6613_8",ce="_oneshotBottomSection_p6613_15",ue="_oneshotTitle_p6613_25",pe="_oneshotQuestionInput_p6613_39",de="_oneshotAnswerContainer_p6613_46",he="_oneshotAnalysisPanel_p6613_53",me="_oneshotSettingsSeparator_p6613_58",Se="_settingsButton_p6613_62",n={oneshotContainer:re,oneshotTopSection:le,oneshotBottomSection:ce,oneshotTitle:ue,oneshotQuestionInput:pe,oneshotAnswerContainer:de,oneshotAnalysisPanel:he,oneshotSettingsSeparator:me,settingsButton:Se};function ge(){const[_,d]=s.useState(!1),[h,B]=s.useState(""),[v,xe]=s.useState(""),[f,Ce]=s.useState(""),[l,E]=s.useState(a.Hybrid),[y,I]=s.useState(3),[m,U]=s.useState(!0),[T,F]=s.useState(!1),[b,H]=s.useState(""),[O,_e]=s.useState(!1),[Q,ve]=s.useState(!1),S=s.useRef(""),[g,A]=s.useState(!1),[c,j]=s.useState(),[i,V]=s.useState(),[k,P]=s.useState(),[u,r]=s.useState(void 0),x=async e=>{S.current=e,c&&j(void 0),A(!0),P(void 0),r(void 0);try{const o={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:h.length===0?void 0:h,prompt_template_prefix:v.length===0?void 0:v,prompt_template_suffix:f.length===0?void 0:f,exclude_category:b.length===0?void 0:b,top:y,retrieval_mode:l,semantic_ranker:m,semantic_captions:T,use_oid_security_filter:O,use_groups_security_filter:Q}},session_state:i?i.choices[0].session_state:null},R=await te(o,"access_token");V(R)}catch(o){j(o)}finally{A(!1)}},D=(e,o)=>{B(o||"")},L=(e,o)=>{I(parseInt(o||"3"))},M=(e,o,R)=>{E(o?.data||a.Hybrid)},q=(e,o)=>{U(!!o)},G=(e,o)=>{F(!!o)},z=(e,o)=>{H(o||"")},J=e=>{x(e)},K=e=>{k===e&&u===p.CitationTab?r(void 0):(P(e),r(p.CitationTab))},C=e=>{r(u===e?void 0:e)};return t.jsxs("div",{className:n.oneshotContainer,children:[t.jsxs("div",{className:n.oneshotTopSection,children:[t.jsx(W,{className:n.settingsButton,onClick:()=>d(!_)}),t.jsx("h1",{className:n.oneshotTitle,children:"Ask your data"}),t.jsx("div",{className:n.oneshotQuestionInput,children:t.jsx(X,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:g,onSend:e=>x(e)})})]}),t.jsxs("div",{className:n.oneshotBottomSection,children:[g&&t.jsx(se,{label:"Generating answer"}),!S.current&&t.jsx(Y,{onExampleClicked:J}),!g&&i&&!c&&t.jsx("div",{className:n.oneshotAnswerContainer,children:t.jsx(Z,{answer:i,isStreaming:!1,onCitationClicked:e=>K(e),onThoughtProcessClicked:()=>C(p.ThoughtProcessTab),onSupportingContentClicked:()=>C(p.SupportingContentTab)})}),c?t.jsx("div",{className:n.oneshotAnswerContainer,children:t.jsx($,{error:c.toString(),onRetry:()=>x(S.current)})}):null,u&&i&&t.jsx(ee,{className:n.oneshotAnalysisPanel,activeCitation:k,onActiveTabChanged:e=>C(e),citationHeight:"600px",answer:i,activeTab:u})]}),t.jsxs(oe,{headerText:"Configure answer generation",isOpen:_,isBlocking:!1,onDismiss:()=>d(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(ne,{onClick:()=>d(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(N,{className:n.oneshotSettingsSeparator,defaultValue:h,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:D}),t.jsx(ae,{className:n.oneshotSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:y.toString(),onChange:L}),t.jsx(N,{className:n.oneshotSettingsSeparator,label:"Exclude category",onChange:z}),t.jsx(w,{className:n.oneshotSettingsSeparator,checked:m,label:"Use semantic ranker for retrieval",onChange:q}),t.jsx(w,{className:n.oneshotSettingsSeparator,checked:T,label:"Use query-contextual summaries instead of whole documents",onChange:G,disabled:!m}),t.jsx(ie,{className:n.oneshotSettingsSeparator,label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:l==a.Hybrid,data:a.Hybrid},{key:"vectors",text:"Vectors",selected:l==a.Vectors,data:a.Vectors},{key:"text",text:"Text",selected:l==a.Text,data:a.Text}],required:!0,onChange:M})]})]})}ge.displayName="OneShot";export{ge as Component};
//# sourceMappingURL=OneShot-85aad53b.js.map
